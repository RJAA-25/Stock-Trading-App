<%= render "partials/header" %>
<main class="flex-1 flex pb-20 lg:pb-0">
  <%= render "partials/navigation", page: "Portfolio" %>
  <section class="flex-1 p-5 lg:px-10 max-w-full overflow-x-auto">
    <%= render "partials/alerts" %>

    <!-- Title -->
    <h1 class="font-bold text-secondary">Property Information</h1>
    <h2 class="text-3xl lg:text-4xl mb-2 font-bold "><%= @property.stock.name %></h2>
    <span class="text-xl mb-3"><%= @property.stock.symbol %></span>

    <!-- Property Information -->
    <div class="my-3 flex mb-3">
      <img 
        src="<%= @property.stock.logo %>" 
        alt="<%= @property.stock.name %> Logo"
        class="object-scale-down bg-white w-32 h-32"/>

      <label class="swap bg-secondary flex-1 relative text-center rounded-xl ml-3 my-3 md:hidden">
        <input class="hidden" type="checkbox" />

        <div class="swap-off sm:flex sm:justify-center sm:gap-10">
          <div class="hidden sm:block">
            <span class="font-bold text-3xl block"><%= format_currency(@property.stock.latest_price) %></span>
            <span>PRICE</span>
          </div>
          <div class="">
            <span class="font-bold text-3xl block"><%= @property.quantity %></span>
            <span>UNITS OWNED</span>
          </div>
        </div>

        <div class="swap-on sm:flex sm:justify-center">
          <div class="sm:hidden">
            <span class="font-bold text-3xl block"><%= format_currency(@property.stock.latest_price) %></span>
            <span>PRICE</span>
          </div>
          <div class="hidden sm:block">
            <span>LAST UPDATE</span>
            <span class="font-bold text-xl block"><%= format_date(@property.stock.updated_at.localtime) %></span>
          </div>
        </div>

        <span class="absolute bottom-1 right-1 btn btn-circle btn-ghost btn-secondary">
          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
            stroke="currentColor" class="w-6 h-6">
            <path stroke-linecap="round" stroke-linejoin="round"
              d="M15.042 21.672L13.684 16.6m0 0l-2.51 2.225.569-9.47 5.227 7.917-3.286-.672zM12 2.25V4.5m5.834.166l-1.591 1.591M20.25 10.5H18M7.757 14.743l-1.59 1.59M6 10.5H3.75m4.007-4.243l-1.59-1.59" />
          </svg>
        </span>
      </label>

      <div class="hidden ml-3 my-3 md:flex md:flex-1 md:justify-evenly md:items-center ">
        <div class="text-center">
          <span class="block font-bold text-3xl lg:text-4xl"><%= format_currency(@property.stock.latest_price) %></span>
          <span>PRICE</span>
        </div>
        <div class="text-center">
          <span class="block font-bold text-3xl lg:text-4xl"><%= @property.quantity %></span>
          <span>UNITS OWNED</span>
        </div>
        <div class="text-center">
          <span>LAST UPDATE</span>
          <span class="block font-bold text-xl"><%= format_date(@property.stock.updated_at.localtime) %></span>
        </div>
      </div>
    </div>

    <div class="my-5 sm:hidden">
      <span>LAST UPDATE</span>
      <span class="block font-bold text-xl"><%= format_date(@property.stock.updated_at.localtime) %></span>
    </div>

    <div class="my-5 flex justify-end">
      <%= link_to "Check #{@property.stock.symbol} Profile", stock_path(@property.stock),
      class: "btn btn-primary" %>
    </div>

    <div class="divider"></div>

    <!-- Latest Transactions -->
    <div class="my-3">
      <h2 class="text-2xl lg:text-3xl mb-5 font-bold">Recent Transactions (<%= @property.stock.symbol %>)</h2>

      <div class="w-11/12 mx-auto overflow-x-auto">

        <div class="flex justify-between py-3">
          <div class="w-44 shrink-0 font-bold">Logo</div>
          <div class="w-44 shrink-0 font-bold">Symbol</div>
          <div class="w-44 shrink-0 font-bold">Type</div>
          <div class="w-44 shrink-0 font-bold">Units</div>
          <div class="w-44 shrink-0 font-bold">Price (per unit)</div>
          <div class="w-44 shrink-0 font-bold">Date Completed</div>
        </div>

        <% @transactions.each do |transaction| %>
        
          <%= render "partials/transaction_item", transaction: transaction, time: true, admin: false %>

        <% end %>

      </div>
    </div>
  </section>
</main>